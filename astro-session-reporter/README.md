# Astro Session Reporter 🔭📝

This project contains a collection of Python scripts designed to analyze and report on data quality and events from an astrophotography observing session. It primarily uses FITS file headers and log files generated by acquisition software (like N.I.N.A.) and guiding software (PHD2).

## Functionality 🛠️

This project includes the following main analysis scripts:

1.  **`phd2_error_anaylsis.py`**: 
    *   Correlates image exposure times (from Autorun logs and FITS headers) with PHD2 guide log data.
    *   Calculates the Root Mean Square (RMS) guiding error (in arcseconds and microns) for RA, Dec, and Total, for each individual image exposure.
    *   Counts the number of "guide star lost" events during each exposure.
    *   Calculates and reports the overall guiding RMS for the entire session.
    *   Outputs results to the console and saves a detailed CSV file.

2.  **`altaz_stats_calculator.py`**:
    *   Scans a directory for FITS files.
    *   Parses the local time from the FITS filename (using a specific pattern like `YYYYMMDD-HHMMSS`).
    *   Reads RA and Dec coordinates from the FITS header.
    *   Uses the observer's location (defined in the script) and the timestamp to calculate the Altitude and Azimuth of the target for each image.
    *   Calculates basic image statistics (mean and standard deviation of pixel values).
    *   Outputs results to the console and saves a CSV file containing filename, timestamp, Alt/Az coordinates, and image statistics.

3.  **`autofocus_analysis.py`**:
    *   Acts as a comprehensive log parser for Autorun logs (likely from N.I.N.A.).
    *   Uses regular expressions to identify and extract various session events, including:
        *   Autofocus details (start, end, success/failure, position)
        *   Guiding events (start/stop, star loss, settling)
        *   Image exposures
        *   Plate solving results
        *   Meridian flips
        *   Mount tracking and slewing
        *   Target coordinates
        *   Wait states
    *   Categorizes these events and saves the data into multiple separate CSV files (one for each major event type, e.g., `autofocus_events.csv`, `guide_events.csv`).

## Project Structure 📁

```
astro-session-reporter/
├── phd2_error_anaylsis.py     # Guiding performance analysis
├── altaz_stats_calculator.py  # Altitude/Azimuth calculation and basic image stats
├── autofocus_analysis.py      # Comprehensive session event log parser
├── README.md                  # This file
└── (output files like *.csv)    # Generated CSV reports
```

*(Note: This project might depend on shared modules previously located in an `astro_modules` directory. Ensure necessary shared code is accessible.)*

## Setup and Usage 🚀

1.  **Prerequisites:**
    *   Python 3.x
    *   Required libraries: `astropy`, `numpy` (and potentially `pytz` or `zoneinfo` depending on your Python version for timezone handling). It's highly recommended to use a virtual environment.
    ```bash
    # Assuming you are in the astro-scripts root directory
    python -m venv .venv
    source .venv/bin/activate # or .\.venv\Scripts\activate on Windows
    pip install astropy numpy pytz # zoneinfo is built-in for Python >= 3.9
    # Consider creating a requirements.txt: pip freeze > requirements.txt
    ```
2.  **Configuration:**
    *   Each script (`phd2_error_anaylsis.py`, `altaz_stats_calculator.py`, `autofocus_analysis.py`) contains user-configurable constants near the top, primarily `LOG_DIR` or `fits_dir`. **You must edit these paths** in each script to point to the directory containing the relevant logs and FITS files for the session you want to analyze.
    *   `phd2_error_anaylsis.py` also requires setting `PIXEL_SCALE_ARCSEC` and `PIXEL_SIZE_UM` for your guide camera setup.
    *   `altaz_stats_calculator.py` requires setting the `observer_location` (Latitude, Longitude, Height).
    *   Review the filename prefixes (`AUTORUN_LOG_PREFIX`, `PHD2_LOG_PREFIX`) and regex patterns within the scripts to ensure they match the format of your log files.
3.  **Run Analysis:**
    *   Navigate to the `astro-scripts` root directory in your terminal (or ensure the `astro-session-reporter` directory is in your Python path).
    *   Execute the desired script(s):
        ```bash
        python astro-session-reporter/phd2_error_anaylsis.py
        python astro-session-reporter/altaz_stats_calculator.py
        python astro-session-reporter/autofocus_analysis.py
        ```
4.  **Output:**
    *   Check the terminal for summary information and processing logs.
    *   Find the generated CSV report files within the session directory specified in the scripts' configuration.

## Notes 📌

*   These scripts rely on specific formats and content within the log files and FITS headers. Adjustments to the parsing logic (especially regular expressions) may be needed depending on your specific acquisition software versions and settings.
*   The `altaz_stats_calculator.py` assumes filenames contain a timestamp in `YYYYMMDD-HHMMSS` format and uses the `America/Los_Angeles` timezone for calculations. Modify the `parse_local_time_from_filename` function and `local_zone` definition if your setup differs. 